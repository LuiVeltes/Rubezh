<UserControl x:Class="DiagnosticsModule.Views.RibbonMenu" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:loc="clr-namespace:DiagnosticsModule.ViewModels">
	<UserControl.Resources>
		<Style TargetType="{x:Type loc:RibbonItem}">
			<Setter Property="Height" Value="40" />
			<Setter Property="MinWidth" Value="40" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type loc:RibbonItem}">
						<Border Name="border" BorderThickness="1" Background="Gray" BorderBrush="Transparent" Padding="2" Margin="2" CornerRadius="2" ToolTip="{TemplateBinding ToolTip}" ToolTipService.ShowOnDisabled="True" Visibility="{TemplateBinding Visibility}">
							<Button Style="{x:Null}" Command="{TemplateBinding Command}" IsEnabled="{Binding Command, RelativeSource={RelativeSource TemplatedParent},Converter={StaticResource NullToBoolConverter}}">
								<Button.Template>
									<ControlTemplate TargetType="{x:Type Button}" >
										<ContentPresenter />
									</ControlTemplate>
								</Button.Template>
								<Grid>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="40" />
										<ColumnDefinition Width="*" />
										<ColumnDefinition Width="20" />
									</Grid.ColumnDefinitions>
									<Image Grid.Column="0" Source="{Binding Path=ImageSource, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource NullToImageConverter}}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="2" />
									<TextBlock Grid.Column="1" Text="{Binding Path=Text, RelativeSource={RelativeSource TemplatedParent}}" HorizontalAlignment="Left" VerticalAlignment="Center" Foreground="White" Margin="2" />
									<Image Grid.Column="2" Source="/Controls;component/Images/Arrow-left-right.png" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="2" Visibility="{Binding Content, RelativeSource={RelativeSource TemplatedParent},Converter={StaticResource NullToVisibilityConverter}}" />
								</Grid>
							</Button>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="border" Property="Border.Background" Value="{DynamicResource HighlightedBackgoundBrush}" />
								<Setter TargetName="border" Property="Border.BorderBrush" Value="{DynamicResource PressedBackgroundBrush}" />
							</Trigger>
							<Trigger Property="IsSelected" Value="True">
								<Setter TargetName="border" Property="Border.Background" Value="{DynamicResource PressedBackgroundBrush}" />
							</Trigger>
							<Trigger Property="IsEnabled" Value="False">
								<Setter TargetName="border" Property="Opacity" Value="0.5" />
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>
		<Style TargetType="{x:Type  loc:RibbonMenu}">
			<Setter Property="OverridesDefaultStyle" Value="True" />
			<Setter Property="SnapsToDevicePixels" Value="True" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type loc:RibbonMenu}">
						<DockPanel>
							<Border DockPanel.Dock="Left" Margin="5" Background="White" BorderBrush="{DynamicResource WindowBorderBrush}" BorderThickness="1" CornerRadius="5">
								<StackPanel IsItemsHost="True" Margin="5" />
							</Border>
							<ContentPresenter x:Name="PART_SelectedContentHost" ContentSource="SelectedContent" />
						</DockPanel>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

	</UserControl.Resources>
	<ContentControl Style="{StaticResource Ribbon}" HorizontalAlignment="Left" VerticalAlignment="Top">
		<ContentControl.Content>
			<loc:RibbonMenu SelectedIndex="-1">
				<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию" />
				<loc:RibbonItem Command="{Binding Menu.LoadFromFileCommand}" Text="Считать" ToolTip="Считать конфигурацию из файла" />
				<loc:RibbonItem Command="{Binding Menu.SaveAsCommand}" Text="Сохранить" ToolTip="Сохранить конфигурацию в файл" />
				<loc:RibbonItem Command="{Binding Menu.LoadFromFileCommand}" ImageSource="/Controls;component/Images/load.png" Text="Считать" ToolTip="Считать конфигурацию из файла" />
				<loc:RibbonItem Command="{Binding Menu.SaveAsCommand}" ImageSource="/Controls;component/Images/save.png" Text="Сохранить" ToolTip="Сохранить конфигурацию в файл" />
				<loc:RibbonItem Command="{Binding Menu.SaveAllCommand}" ImageSource="/Controls;component/Images/SaveAll.png" Text="Сохранить всё" ToolTip="Сохранить всё" Visibility="Collapsed" />
				<loc:RibbonItem Command="{Binding Menu.ValidateCommand}" ImageSource="/Controls;component/Images/check.png" Text="Проверить" ToolTip="Проверить конфигурацию" />
				<loc:RibbonItem Command="{Binding Menu.SetNewConfigCommand}" ImageSource="/Controls;component/Images/download.png" Text="Применить" ToolTip="Применить конфигурацию" />
				<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию">
					<loc:RibbonMenu>
						<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию">
							<loc:RibbonMenu>
								<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию" />
								<loc:RibbonItem Command="{Binding Menu.LoadFromFileCommand}" ImageSource="/Controls;component/Images/load.png" Text="Считать" ToolTip="Считать конфигурацию из файла" />
								<loc:RibbonItem Command="{Binding Menu.SaveAsCommand}" ImageSource="/Controls;component/Images/save.png" Text="Сохранить" ToolTip="Сохранить конфигурацию в файл" />
								<loc:RibbonItem Command="{Binding Menu.SaveAllCommand}" ImageSource="/Controls;component/Images/SaveAll.png" Text="Сохранить всё" ToolTip="Сохранить всё" Visibility="Collapsed" />
								<loc:RibbonItem Command="{Binding Menu.ValidateCommand}" ImageSource="/Controls;component/Images/check.png" Text="Проверить" ToolTip="Проверить конфигурацию" />
								<loc:RibbonItem Command="{Binding Menu.SetNewConfigCommand}" ImageSource="/Controls;component/Images/download.png" Text="Применить" ToolTip="Применить конфигурацию" />
							</loc:RibbonMenu>
						</loc:RibbonItem>
						<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию" />
						<loc:RibbonItem Command="{Binding Menu.LoadFromFileCommand}" ImageSource="/Controls;component/Images/load.png" Text="Считать" ToolTip="Считать конфигурацию из файла" />
						<loc:RibbonItem Command="{Binding Menu.SaveAsCommand}" ImageSource="/Controls;component/Images/save.png" Text="Сохранить" ToolTip="Сохранить конфигурацию в файл" />
						<loc:RibbonItem Command="{Binding Menu.SaveAllCommand}" ImageSource="/Controls;component/Images/SaveAll.png" Text="Сохранить всё" ToolTip="Сохранить всё" Visibility="Collapsed" />
						<loc:RibbonItem Command="{Binding Menu.ValidateCommand}" ImageSource="/Controls;component/Images/check.png" Text="Проверить" ToolTip="Проверить конфигурацию" />
						<loc:RibbonItem Command="{Binding Menu.SetNewConfigCommand}" ImageSource="/Controls;component/Images/download.png" Text="Применить" ToolTip="Применить конфигурацию" />
					</loc:RibbonMenu>
				</loc:RibbonItem>
				<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию">
					<loc:RibbonMenu>
						<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию">
							<loc:RibbonMenu>
								<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию" />
								<loc:RibbonItem Command="{Binding Menu.LoadFromFileCommand}" ImageSource="/Controls;component/Images/load.png" Text="Считать" ToolTip="Считать конфигурацию из файла" />
								<loc:RibbonItem Command="{Binding Menu.SaveAsCommand}" ImageSource="/Controls;component/Images/save.png" Text="Сохранить" ToolTip="Сохранить конфигурацию в файл" />
								<loc:RibbonItem Command="{Binding Menu.SaveAllCommand}" ImageSource="/Controls;component/Images/SaveAll.png" Text="Сохранить всё" ToolTip="Сохранить всё" Visibility="Collapsed" />
								<loc:RibbonItem Command="{Binding Menu.ValidateCommand}" ImageSource="/Controls;component/Images/check.png" Text="Проверить" ToolTip="Проверить конфигурацию" />
								<loc:RibbonItem Command="{Binding Menu.SetNewConfigCommand}" ImageSource="/Controls;component/Images/download.png" Text="Применить" ToolTip="Применить конфигурацию" />
							</loc:RibbonMenu>
						</loc:RibbonItem>
						<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию">
							<loc:RibbonMenu>
								<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию">
									<loc:RibbonMenu>
										<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию" />
										<loc:RibbonItem Command="{Binding Menu.LoadFromFileCommand}" ImageSource="/Controls;component/Images/load.png" Text="Считать" ToolTip="Считать конфигурацию из файла" />
										<loc:RibbonItem Command="{Binding Menu.SaveAsCommand}" ImageSource="/Controls;component/Images/save.png" Text="Сохранить" ToolTip="Сохранить конфигурацию в файл" />
										<loc:RibbonItem Command="{Binding Menu.SaveAllCommand}" ImageSource="/Controls;component/Images/SaveAll.png" Text="Сохранить всё" ToolTip="Сохранить всё" Visibility="Collapsed" />
										<loc:RibbonItem Command="{Binding Menu.ValidateCommand}" ImageSource="/Controls;component/Images/check.png" Text="Проверить" ToolTip="Проверить конфигурацию" />
										<loc:RibbonItem Command="{Binding Menu.SetNewConfigCommand}" ImageSource="/Controls;component/Images/download.png" Text="Применить" ToolTip="Применить конфигурацию" />
									</loc:RibbonMenu>
								</loc:RibbonItem>
								<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию" />
								<loc:RibbonItem Command="{Binding Menu.LoadFromFileCommand}" ImageSource="/Controls;component/Images/load.png" Text="Считать" ToolTip="Считать конфигурацию из файла" />
								<loc:RibbonItem Command="{Binding Menu.SaveAsCommand}" ImageSource="/Controls;component/Images/save.png" Text="Сохранить" ToolTip="Сохранить конфигурацию в файл" />
								<loc:RibbonItem Command="{Binding Menu.SaveAllCommand}" ImageSource="/Controls;component/Images/SaveAll.png" Text="Сохранить всё" ToolTip="Сохранить всё" Visibility="Collapsed" />
								<loc:RibbonItem Command="{Binding Menu.ValidateCommand}" ImageSource="/Controls;component/Images/check.png" Text="Проверить" ToolTip="Проверить конфигурацию" />
								<loc:RibbonItem Command="{Binding Menu.SetNewConfigCommand}" ImageSource="/Controls;component/Images/download.png" Text="Применить" ToolTip="Применить конфигурацию" />
							</loc:RibbonMenu>
						</loc:RibbonItem>
						<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию" />
						<loc:RibbonItem Command="{Binding Menu.LoadFromFileCommand}" ImageSource="/Controls;component/Images/load.png" Text="Считать" ToolTip="Считать конфигурацию из файла" />
						<loc:RibbonItem Command="{Binding Menu.SaveAsCommand}" ImageSource="/Controls;component/Images/save.png" Text="Сохранить" ToolTip="Сохранить конфигурацию в файл" />
						<loc:RibbonItem Command="{Binding Menu.SaveAllCommand}" ImageSource="/Controls;component/Images/SaveAll.png" Text="Сохранить всё" ToolTip="Сохранить всё" Visibility="Collapsed" />
						<loc:RibbonItem Command="{Binding Menu.ValidateCommand}" ImageSource="/Controls;component/Images/check.png" Text="Проверить" ToolTip="Проверить конфигурацию" />
						<loc:RibbonItem Command="{Binding Menu.SetNewConfigCommand}" ImageSource="/Controls;component/Images/download.png" Text="Применить" ToolTip="Применить конфигурацию" />
					</loc:RibbonMenu>
				</loc:RibbonItem>
				<loc:RibbonItem Command="{Binding Menu.CreateNewCommand}" ImageSource="/Controls;component/Images/new.png" Text="Новый" ToolTip="Создать новую конфигурацию" />
				<loc:RibbonItem Command="{Binding Menu.LoadFromFileCommand}" ImageSource="/Controls;component/Images/load.png" Text="Считать" ToolTip="Считать конфигурацию из файла" />
				<loc:RibbonItem Command="{Binding Menu.SaveAsCommand}" ImageSource="/Controls;component/Images/save.png" Text="Сохранить" ToolTip="Сохранить конфигурацию в файл" />
				<loc:RibbonItem Command="{Binding Menu.SaveAllCommand}" ImageSource="/Controls;component/Images/SaveAll.png" Text="Сохранить всё" ToolTip="Сохранить всё" Visibility="Collapsed" />
				<loc:RibbonItem Command="{Binding Menu.ValidateCommand}" ImageSource="/Controls;component/Images/check.png" Text="Проверить" ToolTip="Проверить конфигурацию" />
				<loc:RibbonItem Command="{Binding Menu.SetNewConfigCommand}" ImageSource="/Controls;component/Images/download.png" Text="Применить" ToolTip="Применить конфигурацию" />
			</loc:RibbonMenu>
		</ContentControl.Content>
	</ContentControl>
</UserControl>

<UserControl x:Class="SKDModule.Views.DoorsView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:Controls="clr-namespace:Controls;assembly=Controls"
			 xmlns:Conv="clr-namespace:Controls.Converters;assembly=Controls"
			 xmlns:Converters="clr-namespace:SKDModule.Converters"
			 xmlns:drag="clr-namespace:Infrastructure.Common.Services.DragDrop;assembly=Infrastructure.Common"
			 xmlns:tree="clr-namespace:Controls.TreeList;assembly=Controls"
			 xmlns:viewModel="clr-namespace:SKDModule.ViewModels"
			 xmlns:Views="clr-namespace:SKDModule.Views">

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="*" MinHeight="200" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="75" MinHeight="50" MaxHeight="100" />
		</Grid.RowDefinitions>

		<Controls:XDataGrid Grid.Row="0" CanUserSortColumns="True" ItemsSource="{Binding Doors}" SelectedItem="{Binding SelectedDoor}">
			<DataGrid.Columns>
				<DataGridTemplateColumn Header="Наименование" SortMemberPath="Door.Name" CanUserResize="False" Width="*">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
								<Image Source="{Binding VisualizationState, Converter={StaticResource VisualizationStateToImageSourceConverter}}" Margin="2 0" />
								<Image Source="/Controls;component/Images/Door.png" Margin="2 0" />
								<TextBlock Margin="2, 0, 5, 0" VerticalAlignment="Center" Text="{Binding Door.Name}" />
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
				<DataGridTemplateColumn Header="Устройство входа" CanUserResize="False" Width="*">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<WrapPanel>
								<Image Width="16" Height="16" Source="{Binding InDevice.Driver.ImageSource}" HorizontalAlignment="Left" Margin="5 0" />
								<TextBlock MinWidth="100" VerticalAlignment="Center" Cursor="Hand" Text="{Binding InDeviceName}" TextWrapping="NoWrap">
									<TextBlock.Style>
										<Style TargetType="TextBlock">
											<Style.Triggers>
												<DataTrigger Binding="{Binding IsInDeviceGrayed}" Value="True">
													<Setter Property="TextBlock.Foreground" Value="Gray" />
												</DataTrigger>
											</Style.Triggers>
										</Style>
									</TextBlock.Style>
									<TextBlock.InputBindings>
										<MouseBinding Command="{Binding ChangeInDeviceCommand}" MouseAction="LeftClick" />
									</TextBlock.InputBindings>
									<TextBlock.ToolTip>
										<WrapPanel>
											<TextBlock Text="{Binding InDeviceName}" TextWrapping="Wrap" />
										</WrapPanel>
									</TextBlock.ToolTip>
								</TextBlock>
							</WrapPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
				<DataGridTemplateColumn Header="Устройство выхода" CanUserResize="False" Width="*">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<WrapPanel>
								<Image Width="16" Height="16" Source="{Binding OutDevice.Driver.ImageSource}" HorizontalAlignment="Left" Margin="5 0" />
								<TextBlock MinWidth="100" VerticalAlignment="Center" Cursor="Hand" Text="{Binding OutDeviceName}" TextWrapping="NoWrap">
									<TextBlock.Style>
										<Style TargetType="TextBlock">
											<Style.Triggers>
												<DataTrigger Binding="{Binding IsOutDeviceGrayed}" Value="True">
													<Setter Property="TextBlock.Foreground" Value="Gray" />
												</DataTrigger>
											</Style.Triggers>
										</Style>
									</TextBlock.Style>
									<TextBlock.InputBindings>
										<MouseBinding Command="{Binding ChangeOutDeviceCommand}" MouseAction="LeftClick" />
									</TextBlock.InputBindings>
									<TextBlock.ToolTip>
										<WrapPanel>
											<TextBlock Text="{Binding OutDeviceName}" TextWrapping="Wrap" />
										</WrapPanel>
									</TextBlock.ToolTip>
								</TextBlock>
							</WrapPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
			</DataGrid.Columns>
		</Controls:XDataGrid>

		<GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Transparent" Cursor="SizeNS" />
		<Border Grid.Row="2" DataContext="{Binding SelectedDoor}" Background="{DynamicResource BackgroundBrush}" CornerRadius="5 0 0 5" Margin="0 5 0 0">
			<StackPanel Margin="5">
				<StackPanel Orientation="Horizontal">
					<TextBlock Text="Входное устройство" Foreground="White" Width="150" Margin="2" />
					<Image Width="16" Height="16" Source="{Binding InDevice.Driver.ImageSource}" Margin="2" />
					<TextBlock Text="{Binding InDevice.Name}" Foreground="White" Margin="2" />
				</StackPanel>
				<StackPanel Orientation="Horizontal">
					<TextBlock Text="Выходное устройство" Foreground="White" Width="150" Margin="2" />
					<Image Width="16" Height="16" Source="{Binding OutDevice.Driver.ImageSource}" Margin="2" />
					<TextBlock Text="{Binding OutDevice.Name}" Foreground="White" Margin="2" />
				</StackPanel>
			</StackPanel>
		</Border>
	</Grid>
</UserControl>
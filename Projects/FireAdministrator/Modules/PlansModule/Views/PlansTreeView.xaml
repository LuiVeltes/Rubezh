<UserControl x:Class="PlansModule.Views.PlansTreeView" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:Controls="clr-namespace:Controls;assembly=Controls">
	<Controls:TreeListView ItemsSource="{Binding PlansViewModel.Plans}" SelectedObject="{Binding PlansViewModel.SelectedPlan}">
		<Controls:TreeListView.Resources>
			<InputBindingCollection x:Key="inputCollection" x:Shared="False">
				<MouseBinding Command="{Binding DataContext.PlansViewModel.EditCommand,RelativeSource={RelativeSource AncestorType={x:Type Controls:TreeListView}}}" MouseAction="LeftDoubleClick" />
			</InputBindingCollection>
			<ContextMenu x:Key="contextMenu" DataContext="{Binding DataContext.PlansViewModel,RelativeSource={RelativeSource AncestorType={x:Type Controls:TreeListView}}}">
				<MenuItem Command="{Binding AddSubPlanCommand}" Header="Добавить дочерний план" />
				<MenuItem Command="{Binding EditCommand}" Header="Редактировать" />
				<MenuItem Command="{Binding RemoveCommand}" Header="Удалить" />
			</ContextMenu>
		</Controls:TreeListView.Resources>
		<Controls:TreeListView.ItemContainerStyle>
			<Style BasedOn="{StaticResource {x:Type Controls:TreeListViewItem}}" TargetType="{x:Type Controls:TreeListViewItem}">
				<Setter Property="ContextMenu" Value="{StaticResource contextMenu}" />
				<Setter Property="Controls:Attach.InputBindings" Value="{StaticResource inputCollection}" />
			</Style>
		</Controls:TreeListView.ItemContainerStyle>
		<Controls:TreeListView.Columns>
			<GridViewColumn Width="250" DisplayMemberBinding="{Binding Plan.Caption}" Header="Название" />
			<GridViewColumn DisplayMemberBinding="{Binding Plan.Description}" Header="Описание" />
		</Controls:TreeListView.Columns>
	</Controls:TreeListView>
</UserControl>
<UserControl x:Class="VideoModule.Views.CamerasView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:Controls="clr-namespace:Controls;assembly=Controls"
             xmlns:drag="clr-namespace:Infrastructure.Common.Services.DragDrop;assembly=Infrastructure.Common"
             xmlns:rviVss="clr-namespace:Infrastructure.Common.Video.RVI_VSS;assembly=Infrastructure.Common"
             xmlns:converters="clr-namespace:VideoModule.Converters">
	<UserControl.Resources>
		<SwitchConverter x:Key="Tooltip" Else="{x:Null}">
			<SwitchCase Then="Камера может быть размещена на плане" When="Multiple" />
			<SwitchCase Then="Камера не размещена на плане" When="NotPresent" />
			<SwitchCase Then="Камеру нельзя размещать на плане" When="Prohibit" />
			<SwitchCase Then="Камера уже размещена на плане" When="Single" />
		</SwitchConverter>
        <converters:ChannelToStringConverter x:Key="ChannelToStringConverter" />
	</UserControl.Resources>

    <Controls:XDataGrid Grid.Row="0" ItemsSource="{Binding Cameras}" SelectedItem="{Binding SelectedCamera}">
        <DataGrid.Columns>
			<DataGridTemplateColumn Width="*" Header="Название">
				<DataGridTemplateColumn.CellTemplate>
					<DataTemplate>
						<StackPanel Orientation="Horizontal">
							<drag:DragDropDecorator AllowSimulateDrag="True" DragCommand="{Binding CreateDragObjectCommand}" DragVisualProvider="{Binding CreateDragVisual}" DynamicCursor="True" IsSource="True">
								<Image Margin="2,0,0,0" Source="{Binding VisualizationState, Converter={StaticResource VisualizationStateToImageSourceConverter}}" ToolTip="{Binding VisualizationState, Converter={StaticResource Tooltip}}" />
							</drag:DragDropDecorator>
                            <TextBlock Margin="2, 0, 5, 0" VerticalAlignment="Center" Text="{Binding Camera.Name}" />
						</StackPanel>
					</DataTemplate>
				</DataGridTemplateColumn.CellTemplate>
			</DataGridTemplateColumn>
            <DataGridTextColumn Binding="{Binding Camera.Address}" Header="Адрес" Width="Auto" />
            <DataGridTextColumn Binding="{Binding Camera.ChannelNumber}" Header="Канал" Width="Auto" />
            <DataGridTextColumn Binding="{Binding PresentationZones}" Header="Зоны" Width="*" />
		</DataGrid.Columns>
		<XDataGrid.ContextMenu>
			<ContextMenu OverridesDefaultStyle="True">
				<IconedMenuItem Command="{Binding AddCommand}" ImageSource="/Controls;component/Images/BAdd.png" Text="Добавить (Ctrl+N)" />
				<IconedMenuItem Command="{Binding DeleteCommand}" ImageSource="/Controls;component/Images/BDelete.png" Text="Удалить (Ctrl+Del)" />
				<IconedMenuItem Command="{Binding EditCommand}" ImageSource="/Controls;component/Images/BEdit.png" Text="Редактировать (Ctrl+E)" />
				<Separator />
				<Controls:IconedMenuItem Command="{Binding SelectedCamera.AllowMultipleVizualizationCommand}" CommandParameter="{StaticResource True}" ImageSource="/Controls;component/Images/Eye2.png" Text="Разрешить множественную визуализацию" />
				<Controls:IconedMenuItem Command="{Binding SelectedCamera.AllowMultipleVizualizationCommand}" CommandParameter="{StaticResource False}" ImageSource="/Controls;component/Images/Eye3.png" Text="Запретить множественную визуализацию" />
			</ContextMenu>
		</XDataGrid.ContextMenu>
	</Controls:XDataGrid>
</UserControl>
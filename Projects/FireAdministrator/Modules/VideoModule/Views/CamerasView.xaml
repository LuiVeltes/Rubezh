<UserControl x:Class="VideoModule.Views.CamerasView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:Controls="clr-namespace:Controls;assembly=Controls"
             xmlns:drag="clr-namespace:Infrastructure.Common.Services.DragDrop;assembly=Infrastructure.Common"
             xmlns:rviVss="clr-namespace:Infrastructure.Common.Video.RVI_VSS;assembly=Infrastructure.Common"
             xmlns:converters="clr-namespace:VideoModule.Converters">
	<UserControl.Resources>
		<SwitchConverter x:Key="Tooltip" Else="{x:Null}">
			<SwitchCase Then="Камера может быть размещена на плане" When="Multiple" />
			<SwitchCase Then="Камера не размещена на плане" When="NotPresent" />
			<SwitchCase Then="Камеру нельзя размещать на плане" When="Prohibit" />
			<SwitchCase Then="Камера уже размещена на плане" When="Single" />
		</SwitchConverter>
        <converters:ChannelToStringConverter x:Key="ChannelToStringConverter" />
	</UserControl.Resources>
	<Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" MinHeight="200" />
            <RowDefinition Height="Auto" />
            <RowDefinition MinHeight="150" />
        </Grid.RowDefinitions>
        <Controls:XDataGrid IsDoubleClickOff="{Binding SelectedCamera.IsConnecting}" Grid.Row="0" ItemsSource="{Binding Cameras}" SelectedItem="{Binding SelectedCamera}">
            <DataGrid.Columns>
				<DataGridTemplateColumn Width="200" Header="Название">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
								<drag:DragDropDecorator AllowSimulateDrag="True" DragCommand="{Binding CreateDragObjectCommand}" DragVisualProvider="{Binding CreateDragVisual}" DynamicCursor="True" IsSource="True">
									<Image Margin="2,0,0,0" Source="{Binding VisualizationState, Converter={StaticResource VisualizationStateToImageSourceConverter}}" ToolTip="{Binding VisualizationState, Converter={StaticResource Tooltip}}" />
								</drag:DragDropDecorator>
                                <TextBlock Margin="2, 0, 5, 0" VerticalAlignment="Center" Text="{Binding Name}" />
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
				<DataGridTextColumn Width="200" Binding="{Binding Address}" Header="URL" />
                <DataGridTextColumn Width="200" Binding="{Binding SelectedChannel, Converter={StaticResource ChannelToStringConverter}}" Header="Канал" />
                <DataGridTextColumn Width="200" Binding="{Binding PresentationZones}" Header="Зоны" />
			</DataGrid.Columns>
			<XDataGrid.ContextMenu>
				<ContextMenu OverridesDefaultStyle="True">
					<IconedMenuItem Command="{Binding AddCommand}" ImageSource="/Controls;component/Images/BAdd.png" Text="Добавить (Ctrl+N)" />
					<IconedMenuItem Command="{Binding DeleteCommand}" ImageSource="/Controls;component/Images/BDelete.png" Text="Удалить (Ctrl+Del)" />
					<IconedMenuItem Command="{Binding EditCommand}" ImageSource="/Controls;component/Images/BEdit.png" Text="Редактировать (Ctrl+E)" />
					<Separator />
					<Controls:IconedMenuItem Command="{Binding SelectedCamera.AllowMultipleVizualizationCommand}" CommandParameter="{StaticResource True}" ImageSource="/Controls;component/Images/Eye2.png" Text="Разрешить множественную визуализацию" />
					<Controls:IconedMenuItem Command="{Binding SelectedCamera.AllowMultipleVizualizationCommand}" CommandParameter="{StaticResource False}" ImageSource="/Controls;component/Images/Eye3.png" Text="Запретить множественную визуализацию" />
				</ContextMenu>
			</XDataGrid.ContextMenu>
		</Controls:XDataGrid>
        <GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Transparent" Cursor="SizeNS" />
		<Grid Grid.Row="2">
            <rviVss:CellPlayerWrap Name="PlayerWrap" />
		</Grid>
	</Grid>
</UserControl>
<UserControl x:Class="VideoModule.Views.CamerasView" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:Controls="clr-namespace:Controls;assembly=Controls" xmlns:drag="clr-namespace:Infrastructure.Common.Services.DragDrop;assembly=Infrastructure.Common">
	<UserControl.Resources>
		<SwitchConverter x:Key="Tooltip" Else="{x:Null}">
			<SwitchCase Then="Камера может быть размещено на плане" When="Multiple" />
			<SwitchCase Then="Камера не размещено на плане" When="NotPresent" />
			<SwitchCase Then="Камера нельзя размещать на плане" When="Prohibit" />
			<SwitchCase Then="Камера уже размещено на плане" When="Single" />
		</SwitchConverter>
		<Style x:Key="DataGridCellStyle" TargetType="{x:Type DataGridCell}">
			<Style.Setters>
				<Setter Property="Template">
					<Setter.Value>
						<ControlTemplate TargetType="{x:Type DataGridCell}">
							<Border Background="{TemplateBinding Background}" BorderThickness="0">
								<ContentPresenter VerticalAlignment="Center" />
							</Border>
						</ControlTemplate>
					</Setter.Value>
				</Setter>
			</Style.Setters>
			<Style.Triggers>
				<DataTrigger Binding="{Binding IsNowPlaying}" Value="True">
					<Setter Property="FontStyle" Value="Italic" />
					<Setter Property="FontWeight" Value="Bold" />
				</DataTrigger>
				<Trigger Property="IsSelected" Value="True">
					<Setter Property="Background" Value="{DynamicResource PressedBackgroundBrush}" />
					<Setter Property="Foreground" Value="White" />
				</Trigger>
			</Style.Triggers>
		</Style>
	</UserControl.Resources>
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="300" />
			<RowDefinition Height="*" />
			<RowDefinition Height="50" />
		</Grid.RowDefinitions>
		<Controls:XDataGrid Grid.Row="0" CellStyle="{StaticResource DataGridCellStyle}" ItemsSource="{Binding Cameras}" SelectedItem="{Binding SelectedCamera}">
			<DataGrid.Columns>
				<DataGridTemplateColumn Width="200" Header="Название">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
								<drag:DragDropDecorator AllowSimulateDrag="True" DragCommand="{Binding CreateDragObjectCommand}" DragVisualProvider="{Binding CreateDragVisual}" DynamicCursor="True" IsSource="True">
									<Image Margin="2,0,0,0" Source="{Binding VisualizationState, Converter={StaticResource VisualizationStateToImageSourceConverter}}" ToolTip="{Binding VisualizationState, Converter={StaticResource Tooltip}}" />
								</drag:DragDropDecorator>
								<TextBlock Margin="2, 0, 5, 0" VerticalAlignment="Center" Text="{Binding Camera.Name}" />
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
				<DataGridTextColumn Width="200" Binding="{Binding Camera.Address}" Header="URL" />
				<DataGridTextColumn Width="200" Binding="{Binding PresentationZones}" Header="Зоны" />
			</DataGrid.Columns>
			<XDataGrid.ContextMenu>
				<ContextMenu OverridesDefaultStyle="True">
					<IconedMenuItem Command="{Binding AddCommand}" ImageSource="/Controls;component/Images/BAdd.png" Text="Добавить (Ctrl+N)" />
					<IconedMenuItem Command="{Binding DeleteCommand}" ImageSource="/Controls;component/Images/BDelete.png" Text="Удалить (Ctrl+Del)" />
					<IconedMenuItem Command="{Binding EditCommand}" ImageSource="/Controls;component/Images/BEdit.png" Text="Редактировать (Ctrl+E)" />
					<Separator />
					<Controls:IconedMenuItem Command="{Binding SelectedCamera.AllowMultipleVizualizationCommand}" CommandParameter="{StaticResource True}" ImageSource="/Controls;component/Images/Eye2.png" Text="Разрешить множественную визуализацию" />
					<Controls:IconedMenuItem Command="{Binding SelectedCamera.AllowMultipleVizualizationCommand}" CommandParameter="{StaticResource False}" ImageSource="/Controls;component/Images/Eye3.png" Text="Запретить множественную визуализацию" />
				</ContextMenu>
			</XDataGrid.ContextMenu>
		</Controls:XDataGrid>
		<Grid Grid.Row="1">
			<Grid.Background>
				<VisualBrush AlignmentX="Center" Stretch="Uniform">
					<VisualBrush.Visual>
						<Image Source="{Binding StartedCamera.ImageSource, Mode=OneWay}" />
					</VisualBrush.Visual>
				</VisualBrush>
			</Grid.Background>
		</Grid>
	</Grid>
	<!--
		<Grid>
		<Grid Grid.Row="0">
		<Grid.Background>
		<VisualBrush Stretch="Uniform">
		<VisualBrush.Visual>
		<Image Source="{Binding Path=VideoSequence.Image}" />
		</VisualBrush.Visual>
		</VisualBrush >
		</Grid.Background>
		</Grid>
		</Grid>
	-->
</UserControl>
<UserControl x:Class="AutomationModule.Views.VariablesView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:Controls="clr-namespace:Controls;assembly=Controls" 
			 xmlns:automation="clr-namespace:FiresecAPI.Automation;assembly=FiresecAPI">
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="50" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>
		<StackPanel Grid.Row="0" Orientation="Horizontal">
			<ToolBarButton Command="{Binding AddCommand}" ToolTip="Добавить" ImageSource="/Controls;component/Images/Add.png" />
			<ToolBarButton Command="{Binding EditCommand}" ToolTip="Редактировать" ImageSource="/Controls;component/Images/Edit.png" />
			<ToolBarButton Command="{Binding DeleteCommand}" ToolTip="Удалить" ImageSource="/Controls;component/Images/Delete.png" />
		</StackPanel>
		<Controls:XDataGrid Grid.Row="1" CanUserSortColumns="True" ItemsSource="{Binding Variables}" SelectedItem="{Binding SelectedVariable}" IsReadOnly="False">
			<DataGrid.Columns>
				<DataGridTemplateColumn Header="Имя" Width="*" SortMemberPath="Name" CanUserResize="False">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
								<Image Source="/Controls;component/Images/GlobalVariable.png" Width="16" Margin="2 0 0 0" />
                                <TextBlock Text="{Binding Variable.Name}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="2 0" />
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
				<DataGridTemplateColumn Header="Тип" Width="*">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding Variable.ExplicitType, Converter={StaticResource EnumToDescriptionConverter}}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="2 0" />
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
				<DataGridTemplateColumn Header="Значение" Width="*">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel>
								<StackPanel Visibility="{Binding Path=IsList, Converter={StaticResource InversedBoolToVisibilityConverter}}">
									<TextBlock Text="{Binding ExplicitValue.BoolValue, UpdateSourceTrigger=PropertyChanged}" Margin="2" 
									 Visibility="{Binding Path=ExplicitType, Converter={StaticResource EnumToVisibilityConverter}, 
									ConverterParameter={x:Static automation:ExplicitType.Boolean}}" />
									<TextBlock Text="{Binding ExplicitValue.DateTimeValue, UpdateSourceTrigger=PropertyChanged}" Margin="2"
										 Visibility="{Binding Path=ExplicitType, Converter={StaticResource EnumToVisibilityConverter}, 
									ConverterParameter={x:Static automation:ExplicitType.DateTime}}" />
									<TextBlock Text="{Binding ExplicitValue.IntValue, UpdateSourceTrigger=PropertyChanged}" Margin="2" 
										 Visibility="{Binding Path=ExplicitType, Converter={StaticResource EnumToVisibilityConverter}, 
									ConverterParameter={x:Static automation:ExplicitType.Integer}}" />
									<TextBlock Text="{Binding SelectedObjectType, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource EnumToDescriptionConverter}}" Margin="2"
										 Visibility="{Binding Path=ExplicitType, Converter={StaticResource EnumToVisibilityConverter},
									ConverterParameter={x:Static automation:ExplicitType.Object}}" />
									<TextBlock Text="{Binding SelectedEnumType, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource EnumToDescriptionConverter}}" Margin="2"
										 Visibility="{Binding Path=ExplicitType, Converter={StaticResource EnumToVisibilityConverter},
									ConverterParameter={x:Static automation:ExplicitType.Enum}}" />
									<TextBlock Text="{Binding ExplicitValue.StringValue, UpdateSourceTrigger=PropertyChanged}" Margin="2" 
										 Visibility="{Binding Path=ExplicitType, Converter={StaticResource EnumToVisibilityConverter}, 
									ConverterParameter={x:Static automation:ExplicitType.String}}" />
								</StackPanel>

								<StackPanel Visibility="{Binding Path=IsList, Converter={StaticResource BoolToVisibilityConverter}}">
									<TextBlock Text="{Binding SelectedObjectType, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource EnumToDescriptionConverter}}" Margin="2"
										 Visibility="{Binding Path=ExplicitType, Converter={StaticResource EnumToVisibilityConverter},
									ConverterParameter={x:Static automation:ExplicitType.Object}}" />
									<TextBlock Text="{Binding SelectedEnumType, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource EnumToDescriptionConverter}}" Margin="2"
										 Visibility="{Binding Path=ExplicitType, Converter={StaticResource EnumToVisibilityConverter},
									ConverterParameter={x:Static automation:ExplicitType.Enum}}" />
								</StackPanel>
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
				<DataGridTemplateColumn Header="Список" Width="60" MinWidth="60" MaxWidth="60">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<CheckBox IsChecked="{Binding IsList}" IsEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="2 0" />
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
			</DataGrid.Columns>
		</Controls:XDataGrid>
	</Grid>
</UserControl>
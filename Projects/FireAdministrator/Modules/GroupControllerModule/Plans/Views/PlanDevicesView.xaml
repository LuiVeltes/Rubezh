<UserControl x:Class="GKModule.Plans.Views.PlanDevicesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:Controls="clr-namespace:Controls;assembly=Controls">

    <Controls:TreeListView Name="_tree" ItemsSource="{Binding RootDevices}" SelectedObject="{Binding SelectedDevice}">
        <Controls:TreeListView.Resources>
            <InputBindingCollection x:Key="inputCollection" x:Shared="False">
                <MouseBinding MouseAction="LeftDoubleClick" Command="{Binding ShowOnPlanCommand}" />
            </InputBindingCollection>
        </Controls:TreeListView.Resources>
        <Controls:TreeListView.ItemContainerStyle>
            <Style TargetType="{x:Type Controls:TreeListViewItem}" BasedOn="{StaticResource {x:Type Controls:TreeListViewItem}}">
                <Setter Property="Visibility" Value="{Binding ShowOnPlan, Converter={StaticResource BoolToVisibilityConverter}}" />
                <Setter Property="Controls:Attach.InputBindings" Value="{StaticResource inputCollection}" />
            </Style>
        </Controls:TreeListView.ItemContainerStyle>
        <Controls:TreeListView.Columns>
            <GridViewColumn Header="Устройство" Width="250">
                <GridViewColumn.CellTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <Image Source="/Controls;component/Images/map1.png" Visibility="{Binding Path=Driver.IsPlaceable, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=true}" PreviewMouseDown="On_PreviewMouseDown" MouseMove="On_MouseMove" />
                                <Grid Visibility="{Binding Path=Driver.IsPlaceable, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <Image Source="/Controls;component/Images/map3.png" Visibility="{Binding IsOnPlan, Converter={StaticResource BoolToVisibilityConverter}}" PreviewMouseDown="On_PreviewMouseDown" MouseMove="On_MouseMove" />
                                    <Image Source="/Controls;component/Images/map2.png" Visibility="{Binding IsOnPlan, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=true}" PreviewMouseDown="On_PreviewMouseDown" MouseMove="On_MouseMove" />
                                </Grid>
                                <Image Source="{Binding Device.Driver.ImageSource}" Width="16" Height="16" Margin="5, 0, 5, 0" />
                            </StackPanel>
                            <TextBlock Grid.Column="1" Text="{Binding Device.Driver.ShortName}" VerticalAlignment="Center">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Device.Driver.IsPlaceable}" Value="True">
                                                <DataTrigger.Setters>
                                                    <Setter Property="TextBlock.FontWeight" Value="Bold" />
                                                </DataTrigger.Setters>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </DataTemplate>
                </GridViewColumn.CellTemplate>
            </GridViewColumn>

            <GridViewColumn Header="Адрес" Width="50" DisplayMemberBinding="{Binding Address}" />
            <GridViewColumn Header="Примечание" DisplayMemberBinding="{Binding Description}" />
        </Controls:TreeListView.Columns>
    </Controls:TreeListView >
</UserControl>
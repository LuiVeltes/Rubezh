<UserControl x:Class="SKDModule.Views.ZonesView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:Controls="clr-namespace:Controls;assembly=Controls"
			 xmlns:sys="clr-namespace:System;assembly=mscorlib"
			 xmlns:tree="clr-namespace:Controls.TreeList;assembly=Controls"
			 xmlns:viewModel="clr-namespace:SKDModule.ViewModels"
	         xmlns:Views="clr-namespace:SKDModule.Views">

	<Grid>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="*" MinWidth="200" />
			<ColumnDefinition Width="Auto" />
			<ColumnDefinition Width="*" MinWidth="200" />
		</Grid.ColumnDefinitions>
		<Grid Grid.Column="0" ScrollViewer.IsDeferredScrollingEnabled="True" VirtualizingStackPanel.VirtualizationMode="Recycling">
			<DataGrid Focusable="True" ItemsSource="{Binding Zones}" SelectedItem="{Binding SelectedZone}">
				<DataGrid.Columns>
					<DataGridTemplateColumn Header="Зона" Width="*">
						<DataGridTemplateColumn.CellTemplate>
							<DataTemplate>
								<StackPanel Orientation="Horizontal">
									<Image Source="{Binding State.StateClass, Converter={StaticResource XStateClassToIconConverter}}" Width="16" Height="16" VerticalAlignment="Center" />
									<Image Source="/Controls;component/Images/Zone.png" VerticalAlignment="Center" Margin="1 0 0 0" />
									<TextBlock Text="{Binding Zone.Name}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Width="200">
											<TextBlock.ContextMenu>
												<ContextMenu>
													<Controls:IconedMenuItem ImageSource="/Controls;component/Images/BTurnOn.png" Text="Открыть все двери" Command="{Binding OpenCommand}" />
	                                                <Controls:IconedMenuItem ImageSource="/Controls;component/Images/BTurnOff.png" Text="Закрыть все двери" Command="{Binding CloseCommand}" />
	                                                <Controls:IconedMenuItem ImageSource="/Controls;component/Images/BTurnOn.png" Text="Установить режим ОТКРЫТО" Command="{Binding OpenForeverCommand}" />
	                                                <Controls:IconedMenuItem ImageSource="/Controls;component/Images/BTurnOff.png" Text="Установить режим ЗАКРЫТО" Command="{Binding CloseForeverCommand}" />
													<Controls:IconedMenuItem ImageSource="/Controls;component/Images/Map_black.png" Text="Показать на плане" Command="{Binding ShowOnPlanCommand}" />
	                                                <Controls:IconedMenuItem ImageSource="/Controls;component/Images/BJournal.png" Text="Показать связанные события" Command="{Binding ShowJournalCommand}" />
													<Controls:IconedMenuItem ImageSource="/Controls;component/Images/BSettings.png" Text="Свойства" Command="{Binding ShowPropertiesCommand}" />
												</ContextMenu>
											</TextBlock.ContextMenu>
										</TextBlock>
									<StackPanel.InputBindings>
										<MouseBinding MouseAction="LeftDoubleClick" Command="{Binding ShowOnPlanCommand}" />
									</StackPanel.InputBindings>
	                                <StackPanel.ToolTip>
	                                    <Views:SKDZoneTooltipView />
	                                </StackPanel.ToolTip>
	                            </StackPanel>
							</DataTemplate>
						</DataGridTemplateColumn.CellTemplate>
					</DataGridTemplateColumn>
					<DataGridTextColumn Binding="{Binding Zone.Description}" Header="Примечание" Width="*" />
				</DataGrid.Columns>
			</DataGrid>
		</Grid>
		<GridSplitter Grid.Column="1" Height="5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Transparent" Cursor="SizeWE" />
		<Grid Grid.Column="2" ScrollViewer.IsDeferredScrollingEnabled="True" VirtualizingStackPanel.VirtualizationMode="Recycling" Margin="4 0 0 0">
			<DataGrid ItemsSource="{Binding Devices}">
				<DataGrid.Columns>
					<DataGridTemplateColumn Header="Считыватель, ведущий в зону" Width="*">
						<DataGridTemplateColumn.CellTemplate>
							<DataTemplate>
	                            <TextBlock VerticalAlignment="Center">
								    <Hyperlink Command="{Binding ShowPropertiesCommand}" Style="{StaticResource HyperlinkStyle2}">
									    <StackPanel Orientation="Horizontal">
										    <Image Width="16" Height="16" Margin="5 0" HorizontalAlignment="Left" Source="{Binding Device.Driver.ImageSource}" />
										    <TextBlock HorizontalAlignment="Stretch" Text="{Binding Device.Name}" ToolTip="{Binding Device.Name}" />
									    </StackPanel>
								    </Hyperlink>
							    </TextBlock>
							</DataTemplate>
						</DataGridTemplateColumn.CellTemplate>
					</DataGridTemplateColumn>

					<DataGridTemplateColumn Header="Контроллер" Width="Auto">
						<DataGridTemplateColumn.CellTemplate>
							<DataTemplate>
								<StackPanel Orientation="Horizontal">
									<Image Width="16" Height="16" Margin="5, 0, 5, 0" Source="{Binding Device.Parent.Driver.ImageSource}" />
									<TextBlock Text="{Binding Device.Parent.Name}" />
								</StackPanel>
							</DataTemplate>
						</DataGridTemplateColumn.CellTemplate>
					</DataGridTemplateColumn>
				</DataGrid.Columns>
			</DataGrid>
		</Grid>
	</Grid>
</UserControl>
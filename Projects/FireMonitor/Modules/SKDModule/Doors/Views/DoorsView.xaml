<UserControl x:Class="SKDModule.Views.DoorsView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:Controls="clr-namespace:Controls;assembly=Controls"
			 xmlns:sys="clr-namespace:System;assembly=mscorlib"
			 xmlns:tree="clr-namespace:Controls.TreeList;assembly=Controls"
			 xmlns:viewModel="clr-namespace:SKDModule.ViewModels">

	<Grid ScrollViewer.IsDeferredScrollingEnabled="True" VirtualizingStackPanel.VirtualizationMode="Recycling">
        <DataGrid Focusable="True" ItemsSource="{Binding Doors}" SelectedItem="{Binding SelectedDoor}">
			<DataGrid.Columns>
				<DataGridTemplateColumn Header="Зона" Width="*">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
								<Image Source="{Binding State.StateClass, Converter={StaticResource XStateClassToIconConverter}}" Width="16" Height="16" VerticalAlignment="Center" />
                                <Image Source="/Controls;component/Images/Door.png" VerticalAlignment="Center" Margin="1 0 0 0" />
                                <TextBlock Text="{Binding Door.Name}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Width="200" Margin="2 0 0 0">
										<TextBlock.ContextMenu>
											<ContextMenu>
												<Controls:IconedMenuItem ImageSource="/Controls;component/Images/BTurnOff.png" Text="Открыть" Command="{Binding OpenCommand}" />
                                                <Controls:IconedMenuItem ImageSource="/Controls;component/Images/BTurnOff.png" Text="Закрыть" Command="{Binding CloseCommand}" />
												<Controls:IconedMenuItem ImageSource="/Controls;component/Images/map_black.png" Text="Показать на плане" Command="{Binding ShowOnPlanCommand}" />
												<Controls:IconedMenuItem ImageSource="/Controls;component/Images/BSettings.png" Text="Свойства" Command="{Binding ShowPropertiesCommand}" />
											</ContextMenu>
										</TextBlock.ContextMenu>
										<TextBlock.ToolTip>
											<StackPanel>
												<Image Source="/Controls;component/Images/Door.png" VerticalAlignment="Center" Margin="1 0 0 0" />
												<TextBlock Text="{Binding Door.Name}" FontWeight="Bold" />
											</StackPanel>
										</TextBlock.ToolTip>
									</TextBlock>
								<StackPanel.InputBindings>
									<MouseBinding MouseAction="LeftDoubleClick" Command="{Binding ShowOnPlanCommand}" />
								</StackPanel.InputBindings>
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
                <DataGridTextColumn Binding="{Binding Door.Description}" Header="Примечание" Width="*" />
                <DataGridTemplateColumn Header="Устройство входа" Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Image Width="16" Height="16" Margin="5 0" HorizontalAlignment="Left" Source="{Binding InDevice.Driver.ImageSource}" />
                                <TextBlock MinWidth="100" VerticalAlignment="Center" Text="{Binding InDevice.Name}" TextWrapping="NoWrap">
								<TextBlock.ToolTip>
									<TextBlock Text="{Binding InDevice.Name}" TextWrapping="Wrap" />
								</TextBlock.ToolTip>
							</TextBlock>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="Устройство выхода" Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Image Width="16" Height="16" Margin="5 0" HorizontalAlignment="Left" Source="{Binding OutDevice.Driver.ImageSource}" />
                                <TextBlock MinWidth="100" VerticalAlignment="Center" Text="{Binding OutDevice.Name}" TextWrapping="NoWrap">
								<TextBlock.ToolTip>
									<TextBlock Text="{Binding OutDevice.Name}" TextWrapping="Wrap" />
								</TextBlock.ToolTip>
							</TextBlock>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
		</DataGrid>
	</Grid>
</UserControl>
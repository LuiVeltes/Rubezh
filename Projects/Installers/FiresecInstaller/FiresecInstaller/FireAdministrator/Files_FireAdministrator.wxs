<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  <?include Variables_FireAdministrator.wxi?>
  <Fragment>
    
    <Icon Id="FireAdministratorIcon" SourceFile="Data\Administrator.ico"/>
    <util:CloseApplication Id="FACloseAction" CloseMessage="no" Target="$(var.FireAdministrator.TargetFileName)" RebootPrompt="no" />
    
    <DirectoryRef Id="FIREADMINISTRATORLOCATION">
      <Component Id="FAExeComponent" Guid="*">
        <File Id="FAExe" Name="$(var.FireAdministrator.TargetFileName)"
              Source="$(var.FireAdministrator.TargetPath)" DiskId="1" KeyPath="yes">
        </File>
      </Component>
      <Component Id="FAConfigComponent" Guid="8475B566-E3C8-4A84-93F4-A5FD384F57BF">
        <File Id="FAConfig" Name="FireAdministrator.exe.config" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" Checksum="yes"/>
      </Component>
      <Component Id="FAPrismDllComponent" Guid="*">
        <File Id="FAPrismDll" Name="Microsoft.Practices.Prism.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAPrismUnityExtensionsComponent" Guid="*">
        <File Id="FAPrismUnityExtensionsDll" Name="Microsoft.Practices.Prism.UnityExtensions.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAUnityComponent" Guid="*">
        <File Id="FAUnityDll" Name="Microsoft.Practices.Unity.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAServiceLocationComponent" Guid="*">
        <File Id="FAServiceLocationDll" Name="Microsoft.Practices.ServiceLocation.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAWPFToolkitExtendedComponent" Guid="*">
        <File Id="FAWPFToolkitExtendedDll" Name="WPFToolkit.Extended.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component> 
      <Component Id="FAU2UConsult" Guid="*">
        <File Id="U2UConsult_RichHtmlTextBlock" Name="U2UConsult.RichHtmlTextBlock.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FACommonComponent" Guid="*">
        <File Id="FACommonDll" Name="Common.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAControlsComponent" Guid="*">
        <File Id="FAControlsDll" Name="Controls.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FADeviceControlsComponent" Guid="*">
        <File Id="FADeviceControlsDll" Name="DeviceControls.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAFiresecAPIComponent" Guid="*">
        <File Id="FAFiresecAPIDll" Name="FiresecAPI.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAFiresecClientComponent" Guid="*">
        <File Id="FAFiresecClientDll" Name="FiresecClient.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FADevicesModuleComponent" Guid="*">
        <File Id="FADevicesModuleDll" Name="DevicesModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAInfrastructure.CommonComponent" Guid="*">
        <File Id="FAInfrastructure.CommonDll" Name="Infrastructure.Common.dll"
              Source="$(var.FireAdministrator.TargetDir)" DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAInfrastructure.ClientComponent" Guid="*">
        <File Id="FAInfrastructure.ClientDll" Name="Infrastructure.Client.dll"
              Source="$(var.FireAdministrator.TargetDir)" DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAInfrastructure.PlansComponent" Guid="*">
        <File Id="FAInfrustructure.PlansDll" Name="Infrustructure.Plans.dll"
              Source="$(var.FireAdministrator.TargetDir)" DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAInfrastructureComponent" Guid="*">
        <File Id="FAInfrastructureDll" Name="Infrastructure.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAInstructionsModuleComponent" Guid="4137FF92-794A-4630-A46B-D59A03611E76">
        <File Id="FAInstructionsModuleDll" Name="InstructionsModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" Checksum="yes"/>
      </Component>
      <Component Id="FALibraryModuleComponent" Guid="*">
        <File Id="FALibraryModuleDll" Name="LibraryModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAPlansModuleComponent" Guid="*">
        <File Id="FAPlansModuleDll" Name="PlansModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FASecurityModuleComponent" Guid="*">
        <File Id="FASecurityModuleDll" Name="SecurityModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FASettingsModuleComponent" Guid="*">
        <File Id="FASettingsModuleDll" Name="SettingsModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FASoundsModuleComponent" Guid="*">
        <File Id="FASoundsModuleDll" Name="SoundsModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAFiltersModuleComponent" Guid="*">
        <File Id="FAFiltersModuleDll" Name="FiltersModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      
      <Component Id="FANLogComponent" Guid="*">
        <File Id="FANLogDll" Name="NLog.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FAManualComponent" Guid="*">
        <File Id="FAManualPDF" Name="Manual.pdf" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
      <Component Id="FATreeListViewComponent" Guid="*">
        <File Id="FATreeListViewDll" Name="Ricciolo.Controls.TreeListView.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="FIREADMINISTRATORLOCATION">
      <Component Id="FAGKModuleComponent" Guid="*">
        <File Id="FAGroupControllerModuleDll" Name="GKModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
        <Condition>GK_MODULE</Condition>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="FIREADMINISTRATORLOCATION">
      <Component Id="OPCModuleComponent" Guid="*">
        <File Id="OPCModuleDll" Name="OPCModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
        <Condition>OPC_MODULE</Condition>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="FIREADMINISTRATORLOCATION">
      <Component Id="FASkudModuleComponent" Guid="*">
        <File Id="FASkudModuleDll" Name="SkudModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
        <Condition>SKUD_MODULE</Condition>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="FIREADMINISTRATORLOCATION">
      <Component Id="FAVideoModuleComponent" Guid="67F722A1-31D4-4249-B037-64647FD5CC70">
        <File Id="FAVideoModuleDll" Name="VideoModule.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" KeyPath="yes" />
        <File Id="FAVlcCoreDll" Name="Vlc.DotNet.Core.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" />
        <File Id="FAVlcFormsDll" Name="Vlc.DotNet.Forms.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" />
        <File Id="FAVlcInteropsDll" Name="Vlc.DotNet.Core.Interops.dll" Source="$(var.FireAdministrator.TargetDir)"
              DiskId="1" />
        <Condition>VIDEO_MODULE</Condition>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="FireAdmXslFilesFolder">
      <Component Id="XslFiles1" Guid="*">
        <File Id="svg2xaml.xsl" Source="$(var.FireAdministrator.TargetDir)Configuration\XslFiles\svg2xaml.xsl" />
      </Component>
      <Component Id="XslFiles2" Guid="*">
        <File Id="xaml2svg.xsl" Source="$(var.FireAdministrator.TargetDir)Configuration\XslFiles\xaml2svg.xsl" />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="FireAdmXaml2svgFolder">
      <Component Id="XslFiles3" Guid="*">
        <File Id="animation.xsl" Source="$(var.FireAdministrator.TargetDir)Configuration\XslFiles\xaml2svg\animation.xsl" />
      </Component>
      <Component Id="XslFiles4" Guid="*">
        <File Id="brushes.xsl" Source="$(var.FireAdministrator.TargetDir)Configuration\XslFiles\xaml2svg\brushes.xsl" />
      </Component>
      <Component Id="XslFiles5" Guid="*">
        <File Id="canvas.xsl" Source="$(var.FireAdministrator.TargetDir)Configuration\XslFiles\xaml2svg\canvas.xsl" />
      </Component>
      <Component Id="XslFiles6" Guid="*">
        <File Id="geometry.xsl" Source="$(var.FireAdministrator.TargetDir)Configuration\XslFiles\xaml2svg\geometry.xsl" />
      </Component>
      <Component Id="XslFiles7" Guid="*">
        <File Id="properties.xsl" Source="$(var.FireAdministrator.TargetDir)Configuration\XslFiles\xaml2svg\properties.xsl" />
      </Component>
      <Component Id="XslFiles8" Guid="*">
        <File Id="propertiesMODIF.xsl" Source="$(var.FireAdministrator.TargetDir)Configuration\XslFiles\xaml2svg\properties-MODIF.xsl" />
      </Component>
      <Component Id="XslFiles9" Guid="*">
        <File Id="shapes.xsl" Source="$(var.FireAdministrator.TargetDir)Configuration\XslFiles\xaml2svg\shapes.xsl" />
      </Component>
      <Component Id="XslFiles10" Guid="*">
        <File Id="transform.xsl" Source="$(var.FireAdministrator.TargetDir)Configuration\XslFiles\xaml2svg\transform.xsl" />
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>
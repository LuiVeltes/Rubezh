<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
		 xmlns:util="http://schemas.microsoft.com/wix/UtilExtension"
		 xmlns:sql="http://schemas.microsoft.com/wix/SqlExtension">
	<Fragment>
		<DirectoryRef Id="INSTALLLOCATION">
      <Component Id="DeleteGKXMLSetting" Guid="0B88A0D7-FFCA-4A08-A26A-862308B009B2">
        <CreateFolder Directory="INSTALLLOCATION" />
        <util:XmlConfig Id="XmlFASettingsGK" File="[FIREADMINISTRATORLOCATION]FireAdministrator.exe.config" Action="delete" Node="element"
                        ElementPath="//configuration/modules" On="install"
                        VerifyPath="//configuration/modules/module[\[]@assemblyFile='GKModule.dll'[\]]"
											/>
        <util:XmlConfig Id="XmlFASettingsGK2" File="[FIREMONITORLOCATION]FireMonitor.exe.config" Action="delete" Node="element"
                        ElementPath="//configuration/modules" On="install"
                        VerifyPath="//configuration/modules/module[\[]@assemblyFile='GKModule.dll'[\]]"
											/>
        <Condition>NOT GK_MODULE</Condition>
      </Component>
      
      <Component Id="DeleteOPCXMLSetting" Guid="F0B66E96-0FC0-4CB2-BE16-7EF991083700">
        <CreateFolder Directory="INSTALLLOCATION" />
        <util:XmlConfig Id="XmlFASettingsOPC" File="[FIREADMINISTRATORLOCATION]FireAdministrator.exe.config" Action="delete" Node="element"
                        ElementPath="//configuration/modules" On="install"
                        VerifyPath="//configuration/modules/module[\[]@assemblyFile='OPCModule.dll'[\]]"
											/>
        <Condition>NOT OPC_MODULE</Condition>
      </Component>
      <Component Id="DeleteSKUDXMLSetting" Guid="CDBA5061-EB0B-41A5-8B50-926984D7F879">
        <CreateFolder Directory="INSTALLLOCATION" />
        <util:XmlConfig Id="XmlFASettingsSKUD" File="[FIREADMINISTRATORLOCATION]FireAdministrator.exe.config" Action="delete" Node="element"
                        ElementPath="//configuration/modules" On="install"
                        VerifyPath="//configuration/modules/module[\[]@assemblyFile='SkudModule.dll'[\]]"
											/>
        <Condition>NOT SKUD_MODULE</Condition>
      </Component>
      <Component Id="DeleteVideoXMLSetting" Guid="3111F860-74E6-4E75-B78C-3077273A57E3">
        <CreateFolder Directory="INSTALLLOCATION" />
        <util:XmlConfig Id="XmlFASettingsVIDEO" File="[FIREADMINISTRATORLOCATION]FireAdministrator.exe.config" Action="delete" Node="element"
                        ElementPath="//configuration/modules" On="install"
                        VerifyPath="//configuration/modules/module[\[]@assemblyFile='VideoModule.dll'[\]]"
											/>
        <Condition>NOT VIDEO_MODULE</Condition>
      </Component>
		</DirectoryRef>
		
		<DirectoryRef Id="ProgramMenuDir">
			<Component Id="FiresecProgramsMenuShortcutUninstall" Guid="*">
				<Shortcut Id="FAUninstallProduct" Name="Удалить Firesec-2" Target="[System64Folder]msiexec.exe"
									Arguments="/x [ProductCode]" Description="Удаляет Firesec-2 с данного компьютера" />
				<RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Name="installed" Type="integer"
											 Value="1" KeyPath="yes" />
			</Component>
		</DirectoryRef>

    <DirectoryRef Id="LOGS">
      <Component Id="LogScript" Guid="*">
        <File Id="CopyLogs" Name="CopyLogs.bat" Source="Data\" DiskId="1" KeyPath="yes" />
      </Component>
    </DirectoryRef>

    
	</Fragment>
</Wix>

<!--<Component Id="SqlComponent" Guid="*">
				<CreateFolder Directory="FIRESECSERVICELOCATION" />
				<sql:SqlDatabase Id="FiresecSqlDatabase" Database="Firesec" CreateOnInstall="yes"
												 Server="(local)\[SQLINSTANCE]" DropOnUninstall="no"  ContinueOnError="yes">
					<sql:SqlScript Id="DatabaseStructureScript" BinaryKey="FiresecDBSql" ExecuteOnInstall="yes" ContinueOnError="yes"/>
				</sql:SqlDatabase>
			</Component>-->